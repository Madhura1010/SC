import numpy as np
from sklearn.cluster import KMeans
from sklearn.metrics import mean_squared_error
from scipy.spatial.distance import cdist

# Sample data
np.random.seed(0)
X = np.random.rand(100, 2)
y = np.sin(X[:, 0]) + np.cos(X[:, 1])

# 1. Choose centers using KMeans
k = 10
centers = KMeans(n_clusters=k, random_state=0).fit(X).cluster_centers_

# 2. Compute sigma (spread)
dmax = np.max(cdist(centers, centers))
sigma = dmax / np.sqrt(2 * k)

# 3. Compute RBF matrix
def rbf(x, c, s):
    return np.exp(-np.sum((x - c)**2) / (2*s*s))

R = np.array([[rbf(x, c, sigma) for c in centers] for x in X])

# 4. Compute weights using pseudoinverse
W = np.linalg.pinv(R).dot(y)

# 5. Predict
y_pred = R.dot(W)

# 6. MSE
print("MSE:", round(mean_squared_error(y, y_pred), 6))

Input:
import numpy as np
from scipy.spatial.distance import cdist
from sklearn.cluster import KMeans
from sklearn.metrics import mean_squared_error

# Generate sample data
np.random.seed(0)
X = np.random.rand(100, 2)
y = np.sin(X[:, 0]) + np.cos(X[:, 1])   # removed the "9" typo here

# Define the radial basis function
def rbf(x, c, s):
    return np.exp(-np.linalg.norm(x - c) ** 2 / (2 * s ** 2))

# Choose centers using k-means
kmeans = KMeans(n_clusters=10, random_state=0).fit(X)
centers = kmeans.cluster_centers_

# Calculate the spread parameter (sigma)
d_max = np.max(cdist(centers, centers, 'euclidean'))
sigma = d_max / np.sqrt(2 * len(centers))

# Compute the RBF layer output
R = np.zeros((X.shape[0], len(centers)))
for i in range(X.shape[0]):
    for j in range(len(centers)):
        R[i, j] = rbf(X[i], centers[j], sigma)

# Compute the output weights
W = np.dot(np.linalg.pinv(R), y)

# Define the RBF network prediction function
def rbf_network(X, centers, sigma, W):
    R = np.zeros((X.shape[0], len(centers)))
    for i in range(X.shape[0]):
        for j in range(len(centers)):
            R[i, j] = rbf(X[i], centers[j], sigma)
    return np.dot(R, W)

# Make predictions
y_pred = rbf_network(X, centers, sigma, W)

# Evaluate the model
mse = mean_squared_error(y, y_pred)
print(f"Mean Squared Error: {mse:.6f}")

Output:
Mean Squared Error: 0.023769
